{"ast":null,"code":"'use strict';\n\nvar _ = require('lodash');\n\nvar RestException = require('./RestException');\n/**\n * @constructor\n *\n * @description Base page object to maintain request state.\n *\n * @param {Version} version - A twilio version instance\n * @param {Object} response - The http response\n * @param {Object} solution - path solution\n */\n\n\nfunction Page(version, response, solution) {\n  var payload = this.processResponse(response);\n  this._version = version;\n  this._payload = payload;\n  this._solution = solution;\n  this.nextPageUrl = this.getNextPageUrl();\n  this.previousPageUrl = this.getPreviousPageUrl();\n  this.instances = this.loadInstances(this.loadPage(payload));\n}\n/**\n * @constant META_KEYS\n * @description meta keys returned in a list request\n */\n\n\nPage.prototype.META_KEYS = ['end', 'first_page_uri', 'last_page_uri', 'next_page_uri', 'num_pages', 'page', 'page_size', 'previous_page_uri', 'start', 'total', 'uri'];\n/**\n * Get the url of the previous page of records\n *\n * @return {string|undefined} url of the previous page\n */\n\nPage.prototype.getPreviousPageUrl = function () {\n  if ('meta' in this._payload && 'previous_page_url' in this._payload.meta && this._payload.meta.previous_page_url) {\n    // jshint ignore:line\n    return this._payload.meta.previous_page_url; // jshint ignore:line\n  }\n\n  if ('previous_page_uri' in this._payload && this._payload.previous_page_uri) {\n    // jshint ignore:line\n    return this._version._domain.absoluteUrl(this._payload.previous_page_uri); // jshint ignore:line\n  }\n\n  return undefined;\n};\n/**\n * Get the url of the next page of records\n *\n * @return {string|undefined} url of the next page\n */\n\n\nPage.prototype.getNextPageUrl = function () {\n  if ('meta' in this._payload && 'next_page_url' in this._payload.meta && this._payload.meta.next_page_url) {\n    // jshint ignore:line\n    return this._payload.meta.next_page_url; // jshint ignore:line\n  }\n\n  if ('next_page_uri' in this._payload && this._payload.next_page_uri) {\n    // jshint ignore:line\n    return this._version._domain.absoluteUrl(this._payload.next_page_uri); // jshint ignore:line\n  }\n\n  return undefined;\n};\n/**\n * Build a new instance given a json payload\n * @abstract\n *\n * @param {object} payload - Payload response from the API\n * @return {object} instance of a resource\n */\n\n\nPage.prototype.getInstance = function (payload) {\n  throw new Error('Page.get_instance() must be implemented in the derived class');\n};\n/**\n * Load a list of records\n *\n * @param  {object} resources json payload of records\n * @return {Array} list of resources\n */\n\n\nPage.prototype.loadInstances = function (resources) {\n  return _.map(resources, function (resource) {\n    return this.getInstance(resource);\n  }.bind(this));\n};\n/**\n * Fetch the next page of records\n *\n * @return {promise} promise that resolves to next page of results\n */\n\n\nPage.prototype.nextPage = function () {\n  if (!this.nextPageUrl) {\n    return undefined;\n  }\n\n  var promise = this._version._domain.twilio.request({\n    method: 'GET',\n    uri: this.nextPageUrl\n  });\n\n  promise = promise.then(function (response) {\n    return new this.constructor(this._version, response, this._solution);\n  }.bind(this));\n  return promise;\n};\n/**\n * Fetch the previous page of records\n *\n * @return {promise} promise that resolves to previous page of results\n */\n\n\nPage.prototype.previousPage = function () {\n  if (!this.previousPageUrl) {\n    return undefined;\n  }\n\n  var promise = this._version._domain.twilio.request({\n    method: 'GET',\n    uri: this.previousPageUrl\n  });\n\n  promise = promise.then(function (response) {\n    return new this.constructor(this._version, response, this._solution);\n  }.bind(this));\n  return promise;\n};\n/**\n * Parse json response from API\n * @throws {Error} If non 200 status code is returned\n *\n * @param  {object} response API response\n * @return {object} json parsed response\n */\n\n\nPage.prototype.processResponse = function (response) {\n  if (response.statusCode !== 200) {\n    throw new RestException(response);\n  }\n\n  if (typeof response.body === 'string') {\n    return JSON.parse(response.body);\n  }\n\n  return response.body;\n};\n/**\n * Load a page of records\n * @throws {Error} If records cannot be deserialized\n *\n * @param  {object} payload json payload\n * @return {array} the page of records\n */\n\n\nPage.prototype.loadPage = function (payload) {\n  if ('meta' in payload && 'key' in payload.meta) {\n    return payload[payload.meta.key];\n  }\n\n  var keys = _.chain(payload).keys().difference(this.META_KEYS).value();\n\n  if (keys.length === 1) {\n    return payload[keys[0]];\n  }\n\n  throw new Error('Page Records cannot be deserialized');\n};\n\nmodule.exports = Page;","map":{"version":3,"names":["_","require","RestException","Page","version","response","solution","payload","processResponse","_version","_payload","_solution","nextPageUrl","getNextPageUrl","previousPageUrl","getPreviousPageUrl","instances","loadInstances","loadPage","prototype","META_KEYS","meta","previous_page_url","previous_page_uri","_domain","absoluteUrl","undefined","next_page_url","next_page_uri","getInstance","Error","resources","map","resource","bind","nextPage","promise","twilio","request","method","uri","then","constructor","previousPage","statusCode","body","JSON","parse","key","keys","chain","difference","value","length","module","exports"],"sources":["/Users/hooniesun/rmit/fwp/assessment1/lan/node_modules/twilio/lib/base/Page.js"],"sourcesContent":["'use strict';\n\nvar _ = require('lodash');\nvar RestException = require('./RestException');\n\n/**\n * @constructor\n *\n * @description Base page object to maintain request state.\n *\n * @param {Version} version - A twilio version instance\n * @param {Object} response - The http response\n * @param {Object} solution - path solution\n */\nfunction Page(version, response, solution) {\n  var payload = this.processResponse(response);\n\n  this._version = version;\n  this._payload = payload;\n  this._solution = solution;\n\n  this.nextPageUrl = this.getNextPageUrl();\n  this.previousPageUrl = this.getPreviousPageUrl();\n\n  this.instances = this.loadInstances(this.loadPage(payload));\n}\n\n/**\n * @constant META_KEYS\n * @description meta keys returned in a list request\n */\nPage.prototype.META_KEYS = [\n  'end',\n  'first_page_uri',\n  'last_page_uri',\n  'next_page_uri',\n  'num_pages',\n  'page',\n  'page_size',\n  'previous_page_uri',\n  'start',\n  'total',\n  'uri',\n];\n\n/**\n * Get the url of the previous page of records\n *\n * @return {string|undefined} url of the previous page\n */\nPage.prototype.getPreviousPageUrl = function() {\n  if ('meta' in this._payload && 'previous_page_url' in this._payload.meta && this._payload.meta.previous_page_url) { // jshint ignore:line\n    return this._payload.meta.previous_page_url; // jshint ignore:line\n  }\n\n  if ('previous_page_uri' in this._payload && this._payload.previous_page_uri) { // jshint ignore:line\n    return this._version._domain.absoluteUrl(this._payload.previous_page_uri); // jshint ignore:line\n  }\n\n  return undefined;\n};\n\n/**\n * Get the url of the next page of records\n *\n * @return {string|undefined} url of the next page\n */\nPage.prototype.getNextPageUrl = function() {\n  if ('meta' in this._payload && 'next_page_url' in this._payload.meta && this._payload.meta.next_page_url) { // jshint ignore:line\n    return this._payload.meta.next_page_url; // jshint ignore:line\n  }\n\n  if ('next_page_uri' in this._payload && this._payload.next_page_uri) { // jshint ignore:line\n    return this._version._domain.absoluteUrl(this._payload.next_page_uri); // jshint ignore:line\n  }\n\n  return undefined;\n};\n\n/**\n * Build a new instance given a json payload\n * @abstract\n *\n * @param {object} payload - Payload response from the API\n * @return {object} instance of a resource\n */\nPage.prototype.getInstance = function(payload) {\n  throw new Error('Page.get_instance() must be implemented in the derived class');\n};\n\n/**\n * Load a list of records\n *\n * @param  {object} resources json payload of records\n * @return {Array} list of resources\n */\nPage.prototype.loadInstances = function(resources) {\n  return _.map(resources, function(resource) {\n    return this.getInstance(resource);\n  }.bind(this));\n};\n\n/**\n * Fetch the next page of records\n *\n * @return {promise} promise that resolves to next page of results\n */\nPage.prototype.nextPage = function() {\n  if (!this.nextPageUrl) {\n    return undefined;\n  }\n\n  var promise = this._version._domain.twilio.request({\n    method: 'GET',\n    uri: this.nextPageUrl,\n  });\n\n  promise = promise.then(function(response) {\n    return new this.constructor(this._version, response, this._solution);\n  }.bind(this));\n\n  return promise;\n};\n\n/**\n * Fetch the previous page of records\n *\n * @return {promise} promise that resolves to previous page of results\n */\nPage.prototype.previousPage = function() {\n  if (!this.previousPageUrl) {\n    return undefined;\n  }\n\n  var promise = this._version._domain.twilio.request({\n    method: 'GET',\n    uri: this.previousPageUrl,\n  });\n\n  promise = promise.then(function(response) {\n    return new this.constructor(this._version, response, this._solution);\n  }.bind(this));\n\n  return promise;\n};\n\n/**\n * Parse json response from API\n * @throws {Error} If non 200 status code is returned\n *\n * @param  {object} response API response\n * @return {object} json parsed response\n */\nPage.prototype.processResponse = function(response) {\n  if (response.statusCode !== 200) {\n    throw new RestException(response);\n  }\n\n  if (typeof response.body === 'string') {\n    return JSON.parse(response.body);\n  }\n  return response.body;\n};\n\n/**\n * Load a page of records\n * @throws {Error} If records cannot be deserialized\n *\n * @param  {object} payload json payload\n * @return {array} the page of records\n */\nPage.prototype.loadPage = function(payload) {\n  if ('meta' in payload && 'key' in payload.meta) {\n    return payload[payload.meta.key];\n  }\n\n  var keys = _.chain(payload)\n    .keys()\n    .difference(this.META_KEYS)\n    .value();\n\n  if (keys.length === 1) {\n    return payload[keys[0]];\n  }\n\n  throw new Error('Page Records cannot be deserialized');\n};\n\nmodule.exports = Page;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}