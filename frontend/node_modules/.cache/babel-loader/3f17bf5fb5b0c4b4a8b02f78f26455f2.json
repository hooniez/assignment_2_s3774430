{"ast":null,"code":"var _jsxFileName = \"/Users/hooniesun/rmit/fwp/assessment1/lan/src/UI/MFA.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from \"react\";\nimport { Form, Button, Modal, Spinner } from \"react-bootstrap\";\nimport axios from \"axios\";\nimport { QrCode } from \"react-bootstrap-icons\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function MFA(_ref) {\n  _s();\n\n  let {\n    show,\n    setShow,\n    onSuccess,\n    hideQRcode,\n    user\n  } = _ref;\n  const [qrcodeSrc, setQrcodeSrc] = useState(\"\");\n  const [secret, setSecret] = useState(\"\");\n  const [isOTPcorrect, setIsOTPcorrect] = useState(true);\n  const url = \"https://google-authenticator.p.rapidapi.com\";\n  const apiKey = \"414bc5d180msh86e5db53aea8bbcp1bcd81jsn6915fb5401f0\";\n\n  async function getQrCode() {\n    // options for the initial request to get a secret key\n    let res;\n    let options = {\n      method: \"GET\",\n      url: url + \"/new_v2/\",\n      headers: {\n        \"X-RapidAPI-Key\": apiKey,\n        \"X-RapidAPI-Host\": \"google-authenticator.p.rapidapi.com\"\n      }\n    };\n    res = await axios.request(options);\n    console.log(res.data);\n    setSecret(res.data); // Re-define options again to make a request to get a QR code.\n\n    options = {\n      method: \"GET\",\n      url: url + \"/enroll/\",\n      params: {\n        secret: secret,\n        issuer: \"lan\",\n        account: \"user\"\n      },\n      headers: {\n        \"X-RapidAPI-Key\": apiKey,\n        \"X-RapidAPI-Host\": \"google-authenticator.p.rapidapi.com\"\n      }\n    };\n    res = await axios.request(options);\n    setQrcodeSrc(res.data);\n  }\n\n  useEffect(() => {\n    if (!hideQRcode) {\n      getQrCode();\n    }\n  }, []);\n\n  const submitHandler = e => {\n    e.preventDefault();\n    const code = e.target[0].value;\n    const options = {\n      method: \"GET\",\n      url: url + \"/validate/\",\n      params: {\n        code: code,\n        secret: user ? user.secret : secret\n      },\n      headers: {\n        \"X-RapidAPI-Key\": apiKey,\n        \"X-RapidAPI-Host\": \"google-authenticator.p.rapidapi.com\"\n      }\n    };\n    console.log(options);\n    axios.request(options).then(response => {\n      console.log(response.data);\n\n      if (response.data === \"True\") {\n        if (hideQRcode) {\n          onSuccess();\n        } else {\n          onSuccess(secret);\n        }\n\n        setIsOTPcorrect(true);\n        setShow(false);\n      } else {\n        setIsOTPcorrect(false);\n      }\n    });\n  };\n\n  const handleClose = () => {\n    setShow(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    show: show,\n    onHide: handleClose,\n    children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n      closeButton: true,\n      children: /*#__PURE__*/_jsxDEV(Modal.Title, {\n        className: \"text-center\",\n        hidden: hideQRcode,\n        children: \"Scan the QR code in Google Authenticator\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n      className: \"d-flex justify-content-center\",\n      hidden: hideQRcode,\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        src: qrcodeSrc\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal.Footer, {\n      className: \"d-flex justify-content-center\",\n      children: /*#__PURE__*/_jsxDEV(Form, {\n        onSubmit: submitHandler,\n        children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n          className: \"mb-3 text-center\",\n          controlId: \"authCode\",\n          children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n            children: \"Authentication Code\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n            type: \"text\",\n            required: true,\n            isInvalid: !isOTPcorrect\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Form.Control.Feedback, {\n            type: \"invalid\",\n            children: \"The OTP is incorrect\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            type: \"submit\",\n            children: \"Authenticate\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 5\n  }, this);\n}\n\n_s(MFA, \"6cepK+FTvP8tOFh5IjMc9qUqBk0=\");\n\n_c = MFA;\n\nvar _c;\n\n$RefreshReg$(_c, \"MFA\");","map":{"version":3,"names":["useState","useEffect","Form","Button","Modal","Spinner","axios","QrCode","MFA","show","setShow","onSuccess","hideQRcode","user","qrcodeSrc","setQrcodeSrc","secret","setSecret","isOTPcorrect","setIsOTPcorrect","url","apiKey","getQrCode","res","options","method","headers","request","console","log","data","params","issuer","account","submitHandler","e","preventDefault","code","target","value","then","response","handleClose"],"sources":["/Users/hooniesun/rmit/fwp/assessment1/lan/src/UI/MFA.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { Form, Button, Modal, Spinner } from \"react-bootstrap\";\nimport axios from \"axios\";\nimport { QrCode } from \"react-bootstrap-icons\";\n\nexport default function MFA({ show, setShow, onSuccess, hideQRcode, user }) {\n  const [qrcodeSrc, setQrcodeSrc] = useState(\"\");\n  const [secret, setSecret] = useState(\"\");\n  const [isOTPcorrect, setIsOTPcorrect] = useState(true);\n  const url = \"https://google-authenticator.p.rapidapi.com\";\n  const apiKey = \"414bc5d180msh86e5db53aea8bbcp1bcd81jsn6915fb5401f0\";\n\n  async function getQrCode() {\n    // options for the initial request to get a secret key\n    let res;\n    let options = {\n      method: \"GET\",\n      url: url + \"/new_v2/\",\n      headers: {\n        \"X-RapidAPI-Key\": apiKey,\n        \"X-RapidAPI-Host\": \"google-authenticator.p.rapidapi.com\",\n      },\n    };\n    res = await axios.request(options);\n    console.log(res.data);\n    setSecret(res.data);\n\n    // Re-define options again to make a request to get a QR code.\n    options = {\n      method: \"GET\",\n      url: url + \"/enroll/\",\n      params: {\n        secret: secret,\n        issuer: \"lan\",\n        account: \"user\",\n      },\n      headers: {\n        \"X-RapidAPI-Key\": apiKey,\n        \"X-RapidAPI-Host\": \"google-authenticator.p.rapidapi.com\",\n      },\n    };\n    res = await axios.request(options);\n    setQrcodeSrc(res.data);\n  }\n\n  useEffect(() => {\n    if (!hideQRcode) {\n      getQrCode();\n    }\n  }, []);\n\n  const submitHandler = (e) => {\n    e.preventDefault();\n    const code = e.target[0].value;\n\n    const options = {\n      method: \"GET\",\n      url: url + \"/validate/\",\n      params: { code: code, secret: user ? user.secret : secret },\n      headers: {\n        \"X-RapidAPI-Key\": apiKey,\n        \"X-RapidAPI-Host\": \"google-authenticator.p.rapidapi.com\",\n      },\n    };\n    console.log(options);\n    axios.request(options).then((response) => {\n      console.log(response.data);\n      if (response.data === \"True\") {\n        if (hideQRcode) {\n          onSuccess();\n        } else {\n          onSuccess(secret);\n        }\n\n        setIsOTPcorrect(true);\n        setShow(false);\n      } else {\n        setIsOTPcorrect(false);\n      }\n    });\n  };\n\n  const handleClose = () => {\n    setShow(false);\n  };\n\n  return (\n    <Modal show={show} onHide={handleClose}>\n      <Modal.Header closeButton>\n        <Modal.Title className=\"text-center\" hidden={hideQRcode}>\n          Scan the QR code in Google Authenticator\n        </Modal.Title>\n      </Modal.Header>\n      <Modal.Body className=\"d-flex justify-content-center\" hidden={hideQRcode}>\n        <img src={qrcodeSrc} />\n      </Modal.Body>\n      <Modal.Footer className=\"d-flex justify-content-center\">\n        <Form onSubmit={submitHandler}>\n          <Form.Group className=\"mb-3 text-center\" controlId=\"authCode\">\n            <Form.Label>Authentication Code</Form.Label>\n            <Form.Control\n              type=\"text\"\n              required\n              isInvalid={!isOTPcorrect}\n            ></Form.Control>\n            <Form.Control.Feedback type=\"invalid\">\n              The OTP is incorrect\n            </Form.Control.Feedback>\n          </Form.Group>\n          <div className=\"text-center\">\n            <Button type=\"submit\">Authenticate</Button>\n          </div>\n        </Form>\n      </Modal.Footer>\n    </Modal>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}