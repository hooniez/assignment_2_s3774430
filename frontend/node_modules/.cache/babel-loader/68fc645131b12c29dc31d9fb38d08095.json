{"ast":null,"code":"'use strict';\n\nvar _ = require('lodash');\n\nvar jwt = require('jsonwebtoken');\n\nvar qs = require('querystring');\n/**\n * @constructor\n * @param filters\n */\n\n\nfunction EventStreamScope(filters) {\n  this.filters = filters || {};\n}\n\n_.extend(EventStreamScope.prototype, {\n  scope: 'scope:stream:subscribe',\n  payload: function () {\n    var queryArgs = ['path=/2010-04-01/Events'];\n\n    if (!_.isEmpty(this.filters)) {\n      var queryParams = _.map(this.filters, function (value, key) {\n        return _.join([qs.escape(key), qs.escape(value)], '=');\n      });\n\n      var filterParams = _.join(queryParams, '&');\n\n      queryArgs.push(_.join(['appParams', qs.escape(filterParams)], '='));\n    }\n\n    var queryString = _.join(queryArgs, '&');\n\n    return _.join([this.scope, queryString], '?');\n  }\n});\n/**\n * @constructor\n * @param clientName\n */\n\n\nfunction IncomingClientScope(clientName) {\n  this.clientName = clientName;\n}\n\n_.extend(IncomingClientScope.prototype, {\n  scope: 'scope:client:incoming',\n  payload: function () {\n    var query = _.join(['clientName', qs.escape(this.clientName)], '=');\n\n    return _.join([this.scope, query], '?');\n  }\n});\n/**\n * @constructor\n * @param {object} options - ...\n * @param {string} options.applicationSid - the application sid\n * @param {string} [options.clientName] - the client name\n * @param {object} [options.params] - parameters\n */\n\n\nfunction OutgoingClientScope(options) {\n  if (_.isUndefined(options)) {\n    throw new Error('Required parameter \"options\" missing.');\n  }\n\n  if (_.isUndefined(options.applicationSid)) {\n    throw new Error('Required parameter \"options.applicationSid\" missing.');\n  }\n\n  options = options || {};\n  this.applicationSid = options.applicationSid;\n  this.clientName = options.clientName;\n  this.params = options.params;\n}\n\n_.extend(OutgoingClientScope.prototype, {\n  scope: 'scope:client:outgoing',\n  payload: function () {\n    var queryArgs = [_.join(['appSid', qs.escape(this.applicationSid)], '=')];\n\n    if (_.isString(this.clientName)) {\n      queryArgs.push(_.join(['clientName', qs.escape(this.clientName)], '='));\n    }\n\n    if (_.isObject(this.params)) {\n      var queryParams = _.map(this.params, function (value, key) {\n        return _.join([qs.escape(key), qs.escape(value)], '=');\n      });\n\n      var filterParams = _.join(queryParams, '&');\n\n      queryArgs.push(_.join(['appParams', qs.escape(filterParams)], '='));\n    }\n\n    var queryString = _.join(queryArgs, '&');\n\n    return _.join([this.scope, queryString], '?');\n  }\n});\n/**\n * @constructor\n * @param options\n */\n\n\nfunction ClientCapability(options) {\n  if (_.isUndefined(options)) {\n    throw new Error('Required parameter \"options\" missing.');\n  }\n\n  if (_.isUndefined(options.accountSid)) {\n    throw new Error('Required parameter \"options.accountSid\" missing.');\n  }\n\n  if (_.isUndefined(options.authToken)) {\n    throw new Error('Required parameter \"options.authToken\" missing.');\n  }\n\n  options = options || {};\n  this.accountSid = options.accountSid;\n  this.authToken = options.authToken;\n  this.ttl = options.ttl || 3600;\n  this.scopes = [];\n}\n\nClientCapability.EventStreamScope = EventStreamScope;\nClientCapability.IncomingClientScope = IncomingClientScope;\nClientCapability.OutgoingClientScope = OutgoingClientScope;\n\n_.extend(ClientCapability.prototype, {\n  addScope: function (scope) {\n    this.scopes.push(scope);\n  },\n  toJwt: function () {\n    var payload = {\n      scope: _.join(_.map(this.scopes, function (scope) {\n        return scope.payload();\n      }), ' '),\n      iss: this.accountSid,\n      exp: Math.floor(new Date() / 1000) + this.ttl\n    };\n    return jwt.sign(payload, this.authToken);\n  }\n});\n\nmodule.exports = ClientCapability;","map":{"version":3,"names":["_","require","jwt","qs","EventStreamScope","filters","extend","prototype","scope","payload","queryArgs","isEmpty","queryParams","map","value","key","join","escape","filterParams","push","queryString","IncomingClientScope","clientName","query","OutgoingClientScope","options","isUndefined","Error","applicationSid","params","isString","isObject","ClientCapability","accountSid","authToken","ttl","scopes","addScope","toJwt","iss","exp","Math","floor","Date","sign","module","exports"],"sources":["/Users/hooniesun/rmit/fwp/assessment1/lan/node_modules/twilio/lib/jwt/ClientCapability.js"],"sourcesContent":["'use strict';\n\nvar _ = require('lodash');\nvar jwt = require('jsonwebtoken');\nvar qs = require('querystring');\n\n/**\n * @constructor\n * @param filters\n */\nfunction EventStreamScope(filters) {\n  this.filters = filters || {};\n}\n\n_.extend(EventStreamScope.prototype, {\n  scope: 'scope:stream:subscribe',\n\n  payload: function() {\n    var queryArgs = ['path=/2010-04-01/Events'];\n\n    if (!_.isEmpty(this.filters)) {\n      var queryParams = _.map(this.filters, function(value, key) {\n        return _.join([qs.escape(key), qs.escape(value)], '=');\n      });\n      var filterParams = _.join(queryParams, '&');\n\n      queryArgs.push(_.join(['appParams', qs.escape(filterParams)], '='));\n    }\n\n    var queryString = _.join(queryArgs, '&');\n    return _.join([this.scope, queryString], '?');\n  }\n});\n\n/**\n * @constructor\n * @param clientName\n */\nfunction IncomingClientScope(clientName) {\n  this.clientName = clientName;\n}\n\n_.extend(IncomingClientScope.prototype, {\n  scope: 'scope:client:incoming',\n\n  payload: function() {\n    var query = _.join(['clientName', qs.escape(this.clientName)], '=');\n    return _.join([this.scope, query], '?');\n  }\n});\n\n/**\n * @constructor\n * @param {object} options - ...\n * @param {string} options.applicationSid - the application sid\n * @param {string} [options.clientName] - the client name\n * @param {object} [options.params] - parameters\n */\nfunction OutgoingClientScope(options) {\n  if (_.isUndefined(options)) {\n    throw new Error('Required parameter \"options\" missing.');\n  }\n  if (_.isUndefined(options.applicationSid)) {\n    throw new Error('Required parameter \"options.applicationSid\" missing.');\n  }\n\n  options = options || {};\n  this.applicationSid = options.applicationSid;\n  this.clientName = options.clientName;\n  this.params = options.params;\n}\n\n_.extend(OutgoingClientScope.prototype, {\n  scope: 'scope:client:outgoing',\n\n  payload: function() {\n    var queryArgs = [_.join(['appSid', qs.escape(this.applicationSid)], '=')];\n\n    if (_.isString(this.clientName)) {\n      queryArgs.push(_.join(['clientName', qs.escape(this.clientName)], '='));\n    }\n\n    if (_.isObject(this.params)) {\n      var queryParams = _.map(this.params, function(value, key) {\n        return _.join([qs.escape(key), qs.escape(value)], '=');\n      });\n      var filterParams = _.join(queryParams, '&');\n\n      queryArgs.push(_.join(['appParams', qs.escape(filterParams)], '='));\n    }\n\n    var queryString = _.join(queryArgs, '&');\n    return _.join([this.scope, queryString], '?');\n  }\n});\n\n/**\n * @constructor\n * @param options\n */\nfunction ClientCapability(options) {\n  if (_.isUndefined(options)) {\n    throw new Error('Required parameter \"options\" missing.');\n  }\n  if (_.isUndefined(options.accountSid)) {\n    throw new Error('Required parameter \"options.accountSid\" missing.');\n  }\n  if (_.isUndefined(options.authToken)) {\n    throw new Error('Required parameter \"options.authToken\" missing.');\n  }\n\n  options = options || {};\n  this.accountSid = options.accountSid;\n  this.authToken = options.authToken;\n  this.ttl = options.ttl || 3600;\n  this.scopes = [];\n}\n\nClientCapability.EventStreamScope = EventStreamScope;\nClientCapability.IncomingClientScope = IncomingClientScope;\nClientCapability.OutgoingClientScope = OutgoingClientScope;\n\n_.extend(ClientCapability.prototype, {\n  addScope: function(scope) {\n    this.scopes.push(scope);\n  },\n\n  toJwt: function() {\n    var payload = {\n      scope: _.join(_.map(this.scopes, function(scope) {\n        return scope.payload();\n      }), ' '),\n      iss: this.accountSid,\n      exp: Math.floor(new Date() / 1000) + this.ttl\n    };\n\n    return jwt.sign(payload, this.authToken);\n  }\n});\n\nmodule.exports = ClientCapability;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}